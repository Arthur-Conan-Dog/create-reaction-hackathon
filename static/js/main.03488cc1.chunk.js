(this["webpackJsonpteams-messaging-extension-action-bot"]=this["webpackJsonpteams-messaging-extension-action-bot"]||[]).push([[0],{239:function(e,t,n){},240:function(e,t,n){},241:function(e,t,n){},370:function(e,t,n){},379:function(e,t,n){"use strict";n.r(t);var i=n(1),c=n(37),o=n.n(c),a=(n(239),n(240),n(207)),s=n(144),r=n(20),u=n(117),l=n(115),d=n(116),m=(n(241),n(88)),j=n.n(m),h=n(458),f=n(10),g=function(e){var t=e.userId,n=i.useRef(null),c=i.useRef(null),o=i.useRef(null);i.useEffect((function(){n.current&&b(n.current)}),[n]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("video",{onCanPlay:function(){console.log("can play")},ref:n,className:"videoContainer"}),Object(f.jsx)(d.a,{content:"Take photo",onClick:function(e){p(c.current,n.current,o),e.preventDefault()}}),Object(f.jsx)("canvas",{ref:c,className:"canvasContainer"}),Object(f.jsx)(d.a,{content:"Upload",onClick:function(){!function(e,t){j.a.post("https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji",{emoji_id:new h.a,emoji_display_name:"test",emoji_autho_userId:e,emoji_state:1,emoji_base64_content:JSON.stringify(t)}).then((function(e){console.log("upload succeed")})).catch((function(e){console.log("upload failed: ".concat(e))}))}(t,o.current)}}),Object(f.jsx)(d.a,{content:"Cancel",onClick:function(){x(c.current,o.current)}})]})},b=function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e.srcObject=t,e.play()})).catch((function(e){console.log("An error occurred: "+e)}))},p=function(e,t,n){var i=e.getContext("2d");e.width=320,e.height=240,i.drawImage(t,0,0,320,240);var c=e.toDataURL("image/png").replace("image/png","image/octet-stream");n.current=c,console.log("take photo")},x=function(e,t){var n=e.getContext("2d");n.fillStyle="#AAA",n.fillRect(0,0,e.width,e.height),console.log("photo: ".concat(JSON.stringify(null)))},v=n(226),O=n(446),y=n(58),C=n(50),I=n(447),w=n(448),_=n(228),k=n(214),S=n(215),A=n.n(S),E=["WandaHoward","TimDeboer","RobinCounts","RobertTolbert","MonaKane","MiguelGarcia","MauricioAugust","LydiaBauer","KristinPatterson","KevinSturgis","KatriAthokas","KatLarsson","JohnieMcConnell","IsaacFielder","HenryBrill","ErikNason","ElviaAtkins"],M={width:"calc(100% - 10px)",height:"80%",margin:"10px 5px"},R=function(e){var t=e.style,n=i.useRef(null),c=i.useCallback((function(){n&&n.current&&n.current.click()})),o=i.useCallback((function(e){}));return Object(f.jsxs)("div",{style:t,children:[Object(f.jsx)("input",{id:"fileButton",ref:n,onChange:o,type:"file",hidden:!0}),Object(f.jsxs)(d.a,{text:!0,styles:M,onClick:c,children:[Object(f.jsx)(O.a,{}),Object(f.jsx)(y.a,{weight:"semibold",content:"Upload Emoji"})]},"add_emoji")]})},N=function(e){var t=e.columnIndex,n=e.data,i=e.rowIndex,c=e.style,o=i*n.columnCount+t,a=n.items&&n.items.length>o?n.items[o]:null;if(!a)return null;if("add-emoji"===a.id)return Object(f.jsx)(R,{style:c});var s=function(e){!function(e,t,n,i,c){j.a.post("https://www.l2b.ltd/api/message-reactions",{emoji_id:e,user_id:t,message_id:n,chat_id:i,emoji_url:c}).then((function(){console.log("select image succeed")})).catch((function(e){console.log("select image failed: ".concat(e))}))}(e.id,n.userId,n.messageId,n.convId,e.src)};return Object(f.jsx)("div",{style:c,children:Object(f.jsx)(d.a,{styles:M,text:!0,title:a.name,onClick:function(){return s(a)},children:Object(f.jsx)(C.a,{style:{maxHeight:"100%",maxWidth:"100%"},src:a.src})},a.id)})},D=function(e){var t=e.messageId,n=e.userId,c=e.convId,o=i.useState([]),a=Object(u.a)(o,2),s=a[0],r=a[1];i.useEffect((function(){j.a.get("https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji",{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){return console.log("fetch images succeed: ".concat(e)),JSON.parse(e).map((function(e){return{id:e.emoji_id,name:e.emoji_display_name,source:e.emoji_url}}))})).catch((function(e){console.log("fetch images failed: ".concat(e))})).then((function(e){r(e||A.a.map(E,(function(e){return{id:e,name:e,src:"https://fabricweb.azureedge.net/fabric-website/assets/images/avatar/".concat(e,".jpg")}})))}))}),[]);var l=[{id:"add-emoji"}].concat(Object(v.a)(s)),d=Math.ceil(l.length/6),m=i.useMemo((function(){return{columnCount:6,items:l,messageId:t,userId:n,convId:c}})),h=Object(f.jsx)(k.a,{children:function(e){return function(e,t){var n=Math.floor(t/6);return Object(f.jsx)(_.a,{className:"FixedSizeGrid",columnCount:6,rowCount:d,width:t,height:e,columnWidth:n,rowHeight:150,initialScrollTop:0,itemData:m,style:{overflowX:"hidden"},children:N})}(e.height,e.width)}});return Object(f.jsx)(I.a,{accessibility:w.a,content:h,style:{height:"100%",width:"100%"}})},J=(n(370),[{key:"custom_emojis",content:"Custom Emojis"},{key:"shoot_emoji",content:"Shoot emoji"}]),K=function(){var e=new URLSearchParams(Object(r.d)().search),t=e.get("messageId"),n=e.get("userId"),c=e.get("convId"),o=i.useState(0),a=Object(u.a)(o,2),s=a[0],d=a[1],m=i.useCallback((function(e,t){d(t.activeIndex)}));return Object(f.jsxs)("div",{id:"main-page",style:{height:"100%"},children:[Object(f.jsx)(l.a,{defaultActiveIndex:0,items:J,underlined:!0,primary:!0,onActiveIndexChange:m}),0===s&&Object(f.jsx)(D,{messageId:t,userId:n,convId:c}),1===s&&Object(f.jsx)(g,{userId:n})]})};var T=function(){return a?Object(f.jsx)(s.a,{children:Object(f.jsx)(K,{})}):Object(f.jsx)("h3",{children:"Microsoft Teams SDK not found."})},U=n(456),z=n(455);o.a.render(Object(f.jsx)(U.a,{theme:z.a,children:Object(f.jsx)(T,{})}),document.getElementById("root"))}},[[379,1,2]]]);
//# sourceMappingURL=main.03488cc1.chunk.js.map
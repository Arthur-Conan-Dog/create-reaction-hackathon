{"version":3,"sources":["components/Camera.jsx","components/data.js","components/MockData.js","components/CustomEmojis.jsx","components/MainPage.jsx","components/App.js","index.js"],"names":["Camera","userId","videoRef","React","canvasRef","photoRef","current","init","onCanPlay","console","log","ref","className","Button","content","onClick","e","takePicture","preventDefault","photo","axios","post","emoji_id","uuid","emoji_display_name","emoji_autho_userId","emoji_state","emoji_base64_content","JSON","stringify","then","response","catch","uploadUserImage","clearPhoto","video","navigator","mediaDevices","getUserMedia","audio","stream","srcObject","play","err","canvas","context","getContext","width","height","drawImage","data","toDataURL","replace","fillStyle","fillRect","imageNames","imageButtonStyles","margin","AddEmoji","style","fileInputRef","onAddButtonClick","click","fileUploadInputChange","id","onChange","type","hidden","text","styles","AddIcon","Text","weight","EmojiRenderer","props","columnIndex","rowIndex","index","columnCount","item","items","length","onEmojiClick","emoji","emojiId","msgId","chatId","emotionSrc","user_id","message_id","chat_id","emoji_url","selectCustomImage","messageId","convId","src","title","name","Image","maxHeight","maxWidth","CustomEmojisComponent","allEmojis","setAllEmojis","get","headers","parse","map","image","source","emojis","_","imageName","gridData","rowCount","Math","ceil","itemData","virtualizedGrid","columnWidth","floor","rowHeight","initialScrollTop","overflowX","autoSizerChild","Grid","accessibility","gridHorizontalBehavior","key","MainPage","query","URLSearchParams","useLocation","search","activeIndex","setActiveIndex","onActiveIndexChange","i","j","Menu","defaultActiveIndex","underlined","primary","App","microsoftTeams","ReactDOM","render","Provider","theme","teamsTheme","document","getElementById"],"mappings":"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","file":"static/js/main.03488cc1.chunk.js","sourcesContent":["import * as React from \"react\";\r\nimport { Button } from \"@fluentui/react-northstar\";\r\nimport \"./Camera.css\";\r\nimport { uploadUserImage } from \"./data\";\r\n\r\nconst width = 320;\r\nconst height = 240;\r\n\r\nexport const Camera = ({ userId }) => {\r\n  const videoRef = React.useRef(null);\r\n  const canvasRef = React.useRef(null);\r\n  const photoRef = React.useRef(null);\r\n  React.useEffect(() => {\r\n    if (videoRef.current) {\r\n      init(videoRef.current);\r\n    }\r\n  }, [videoRef]);\r\n\r\n  const onCameraClick = (e) => {\r\n    takePicture(canvasRef.current, videoRef.current, photoRef);\r\n    e.preventDefault();\r\n  };\r\n\r\n  const onConfirmClick = () => {\r\n    // upload to server\r\n    uploadUserImage(userId, photoRef.current);\r\n  };\r\n\r\n  const onCancelClick = () => {\r\n    clearPhoto(canvasRef.current, photoRef.current);\r\n  };\r\n\r\n  const onVideoCanPlay = () => {\r\n    console.log(\"can play\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <video\r\n        onCanPlay={onVideoCanPlay}\r\n        ref={videoRef}\r\n        className={\"videoContainer\"}\r\n      ></video>\r\n      <Button content={\"Take photo\"} onClick={onCameraClick} />\r\n      <canvas ref={canvasRef} className={\"canvasContainer\"}></canvas>\r\n      <Button content={\"Upload\"} onClick={onConfirmClick} />\r\n      <Button content={\"Cancel\"} onClick={onCancelClick} />\r\n    </>\r\n  );\r\n};\r\n\r\nexport const init = (video) => {\r\n  navigator.mediaDevices\r\n    .getUserMedia({\r\n      video: true,\r\n      audio: false,\r\n    })\r\n    .then(function (stream) {\r\n      video.srcObject = stream;\r\n      video.play();\r\n    })\r\n    .catch(function (err) {\r\n      console.log(\"An error occurred: \" + err);\r\n    });\r\n};\r\n\r\nexport const takePicture = (canvas, video, photoRef) => {\r\n  var context = canvas.getContext(\"2d\");\r\n  if (width && height) {\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    context.drawImage(video, 0, 0, width, height);\r\n\r\n    var data = canvas\r\n      .toDataURL(\"image/png\")\r\n      .replace(\"image/png\", \"image/octet-stream\");\r\n    photoRef.current = data;\r\n    console.log(`take photo`);\r\n  } else {\r\n    clearPhoto(canvas, photo);\r\n  }\r\n};\r\n\r\nexport const clearPhoto = (canvas, photo) => {\r\n  var context = canvas.getContext(\"2d\");\r\n  context.fillStyle = \"#AAA\";\r\n  context.fillRect(0, 0, canvas.width, canvas.height);\r\n  photo = null;\r\n  console.log(`photo: ${JSON.stringify(photo)}`);\r\n};\r\n","import axios from \"axios\";\r\nimport {v4 as uuid} from 'uuid';\r\n\r\nexport const uploadUserImage = (userId, photo) => {\r\n  axios\r\n    .post(\"https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji\", {\r\n     emoji_id: new uuid(),\r\n     emoji_display_name:\"test\",\r\n     emoji_autho_userId: userId,\r\n     emoji_state:1,\r\n     emoji_base64_content: JSON.stringify(photo),\r\n    })\r\n    .then((response) => {\r\n      // check image id?\r\n      console.log(\"upload succeed\");\r\n    })\r\n    .catch((e) => {\r\n      console.log(`upload failed: ${e}`);\r\n    });\r\n};\r\n\r\nexport const deleteUserImage = () => {\r\n  axios\r\n    .delete(\"\", { userId })\r\n    .then(() => {\r\n      console.log(\"delete images succeed\");\r\n    })\r\n    .catch((e) => {\r\n      console.log(`delete images failed: ${e}`);\r\n    });\r\n};\r\n\r\nexport const getCustomImages = (userId) => {\r\n return axios\r\n    .get(`https://customemojiwebapiapi.azure-api.net/v1/CustomEmoji`,{headers:{'Access-Control-Allow-Origin' : '*'}})\r\n    .then((response) => {\r\n      console.log(`fetch images succeed: ${response}`);\r\n      const images = JSON.parse(response);\r\n      return images.map((image) => {\r\n      return {\r\n          id: image.emoji_id,\r\n          name: image.emoji_display_name,\r\n          source: image.emoji_url,\r\n        };\r\n      });\r\n    })\r\n    .catch((e) => {\r\n      console.log(`fetch images failed: ${e}`);\r\n    });\r\n};\r\n\r\nexport const selectCustomImage = (\r\n  emojiId,\r\n  userId,\r\n  msgId,\r\n  chatId,\r\n  emotionSrc\r\n) => {\r\n  axios\r\n    .post(\"https://www.l2b.ltd/api/message-reactions\", {\r\n      emoji_id: emojiId,\r\n      user_id: userId,\r\n      message_id: msgId,\r\n      chat_id: chatId,\r\n      emoji_url: emotionSrc,\r\n    })\r\n    .then(() => {\r\n      console.log(\"select image succeed\");\r\n    })\r\n    .catch((e) => {\r\n      console.log(`select image failed: ${e}`);\r\n    });\r\n};\r\n","import _ from \"lodash\";\r\n\r\nconst imageNames = [\r\n  \"WandaHoward\",\r\n  \"TimDeboer\",\r\n  \"RobinCounts\",\r\n  \"RobertTolbert\",\r\n  \"MonaKane\",\r\n  \"MiguelGarcia\",\r\n  \"MauricioAugust\",\r\n  \"LydiaBauer\",\r\n  \"KristinPatterson\",\r\n  \"KevinSturgis\",\r\n  \"KatriAthokas\",\r\n  \"KatLarsson\",\r\n  \"JohnieMcConnell\",\r\n  \"IsaacFielder\",\r\n  \"HenryBrill\",\r\n  \"ErikNason\",\r\n  \"ElviaAtkins\",\r\n];\r\n\r\nexport const getAllMockEmojis = () =>\r\n  _.map(imageNames, (imageName) => ({\r\n    id: imageName,\r\n    name: imageName,\r\n    src: `https://fabricweb.azureedge.net/fabric-website/assets/images/avatar/${imageName}.jpg`,\r\n  }));\r\n","import * as React from \"react\";\r\nimport {\r\n  Grid,\r\n  Image,\r\n  Button,\r\n  gridHorizontalBehavior,\r\n  AddIcon,\r\n  Text,\r\n} from \"@fluentui/react-northstar\";\r\nimport { FixedSizeGrid } from \"react-window\";\r\nimport AutoSizer from \"react-virtualized-auto-sizer\";\r\nimport { getAllMockEmojis } from \"./MockData\";\r\nimport { getCustomImages, selectCustomImage } from \"./data\";\r\n\r\nconst imageButtonStyles = {\r\n  width: \"calc(100% - 10px)\",\r\n  height: \"80%\",\r\n  margin: \"10px 5px\",\r\n};\r\n\r\nconst AddEmoji = ({ style }) => {\r\n  const fileInputRef = React.useRef(null);\r\n\r\n  const onAddButtonClick = React.useCallback(() => {\r\n    if (fileInputRef && fileInputRef.current) {\r\n      fileInputRef.current.click();\r\n    }\r\n  });\r\n\r\n  const fileUploadInputChange = React.useCallback((e) => {\r\n    // Todo: get upload file and update to server\r\n    // uploaded file: e.target.value\r\n  });\r\n\r\n  return (\r\n    <div style={style}>\r\n      <input\r\n        id=\"fileButton\"\r\n        ref={fileInputRef}\r\n        onChange={fileUploadInputChange}\r\n        type=\"file\"\r\n        hidden\r\n      />\r\n      <Button\r\n        text\r\n        key={\"add_emoji\"}\r\n        styles={imageButtonStyles}\r\n        onClick={onAddButtonClick}\r\n      >\r\n        <AddIcon />\r\n        <Text weight=\"semibold\" content=\"Upload Emoji\" />\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst EmojiRenderer = (props) => {\r\n  const { columnIndex, data, rowIndex, style } = props;\r\n  const index = rowIndex * data.columnCount + columnIndex;\r\n\r\n  const item =\r\n    data.items && data.items.length > index ? data.items[index] : null;\r\n  if (!item) {\r\n    return null;\r\n  }\r\n  if (item.id === \"add-emoji\") {\r\n    return <AddEmoji style={style} />;\r\n  }\r\n\r\n  const onEmojiClick = (emoji) => {\r\n    selectCustomImage(\r\n      emoji.id,\r\n      data.userId,\r\n      data.messageId,\r\n      data.convId,\r\n      emoji.src\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div style={style}>\r\n      <Button\r\n        styles={imageButtonStyles}\r\n        text\r\n        key={item.id}\r\n        title={item.name}\r\n        onClick={() => onEmojiClick(item)}\r\n      >\r\n        <Image style={{ maxHeight: \"100%\", maxWidth: \"100%\" }} src={item.src} />\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const CustomEmojisComponent = ({ messageId, userId, convId }) => {\r\n  const [allEmojis, setAllEmojis] = React.useState([]);\r\n  React.useEffect(() => {\r\n    getCustomImages(userId).then((emojis) => {\r\n      if (!emojis) {\r\n        setAllEmojis(getAllMockEmojis());\r\n      } else {\r\n        setAllEmojis(emojis);\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const gridData = [{ id: \"add-emoji\" }, ...allEmojis];\r\n\r\n  const columnCount = 6;\r\n  const rowCount = Math.ceil(gridData.length / columnCount);\r\n  const itemData = React.useMemo(() => ({\r\n    columnCount,\r\n    items: gridData,\r\n    messageId,\r\n    userId,\r\n    convId,\r\n  }));\r\n\r\n  const autoSizerChild = (height, width) => {\r\n    const columnWidth = Math.floor(width / columnCount);\r\n    return (\r\n      <FixedSizeGrid\r\n        className={\"FixedSizeGrid\"}\r\n        columnCount={columnCount}\r\n        rowCount={rowCount}\r\n        width={width}\r\n        height={height}\r\n        columnWidth={columnWidth}\r\n        rowHeight={150}\r\n        initialScrollTop={0}\r\n        itemData={itemData}\r\n        style={{ overflowX: \"hidden\" }}\r\n      >\r\n        {EmojiRenderer}\r\n      </FixedSizeGrid>\r\n    );\r\n  };\r\n\r\n  const virtualizedGrid = (\r\n    <AutoSizer>\r\n      {({ height, width }) => autoSizerChild(height, width)}\r\n    </AutoSizer>\r\n  );\r\n\r\n  return (\r\n    <Grid\r\n      accessibility={gridHorizontalBehavior}\r\n      content={virtualizedGrid}\r\n      style={{ height: \"100%\", width: \"100%\" }}\r\n    />\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { Menu } from \"@fluentui/react-northstar\";\r\nimport { Camera } from \"./Camera\";\r\nimport { CustomEmojisComponent } from \"./CustomEmojis\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport \"./MainPage.css\";\r\n\r\nconst items = [\r\n  {\r\n    key: \"custom_emojis\",\r\n    content: \"Custom Emojis\",\r\n  },\r\n  {\r\n    key: \"shoot_emoji\",\r\n    content: \"Shoot emoji\",\r\n  },\r\n];\r\n\r\nexport const MainPage = () => {\r\n  const query = new URLSearchParams(useLocation().search);\r\n  const messageId = query.get(\"messageId\");\r\n  const userId = query.get(\"userId\");\r\n  const convId = query.get(\"convId\");\r\n\r\n  const [activeIndex, setActiveIndex] = React.useState(0);\r\n  const onActiveIndexChange = React.useCallback((i, j) => {\r\n    setActiveIndex(j.activeIndex);\r\n  });\r\n\r\n  return (\r\n    <div id=\"main-page\" style={{ height: \"100%\" }}>\r\n      <Menu\r\n        defaultActiveIndex={0}\r\n        items={items}\r\n        underlined\r\n        primary\r\n        onActiveIndexChange={onActiveIndexChange}\r\n      />\r\n      {activeIndex === 0 && (\r\n        <CustomEmojisComponent\r\n          messageId={messageId}\r\n          userId={userId}\r\n          convId={convId}\r\n        />\r\n      )}\r\n      {activeIndex === 1 && <Camera userId={userId} />}\r\n    </div>\r\n  );\r\n};\r\n","// Copyright (c) Microsoft Corporation.\r\n// Licensed under the MIT License.\r\n\r\nimport React from \"react\";\r\nimport \"./App.css\";\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\nimport { BrowserRouter as Router, useLocation } from \"react-router-dom\";\r\n\r\nimport { MainPage } from \"./MainPage\";\r\n\r\n/**\r\n * The main app which handles the initialization and routing\r\n * of the app.\r\n */\r\nfunction App() {\r\n  // Check for the Microsoft Teams SDK object.\r\n  if (microsoftTeams) {\r\n    return (\r\n      <Router>\r\n        <MainPage />\r\n      </Router>\r\n    );\r\n  } else {\r\n    return <h3>Microsoft Teams SDK not found.</h3>;\r\n  }\r\n}\r\n\r\nfunction Parent() {\r\n  const query = new URLSearchParams(useLocation().search);\r\n  console.log(query.toString());\r\n  return (\r\n    <Child\r\n      messageId={query.get(\"messageId\")}\r\n      userId={query.get(\"userId\")}\r\n      convId={query.get(\"convId\")}\r\n    />\r\n  );\r\n}\r\n\r\nfunction Child({ messageId, userId, convId }) {\r\n  return (\r\n    <div>\r\n      <h1>messageId: {messageId} </h1>\r\n      <h1>userId: {userId} </h1>\r\n      <h1>convId: {convId} </h1>\r\n      <MainPage messageId={messageId} userId={userId} convId={convId} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport { Provider, teamsTheme } from '@fluentui/react-northstar' //https://fluentsite.z22.web.core.windows.net/quick-start\n\nReactDOM.render(\n    <Provider theme={teamsTheme}>\n        <App />\n    </Provider>, document.getElementById('root')\n);\n"],"sourceRoot":""}